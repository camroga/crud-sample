package service;import com.google.gson.Gson;import com.google.gson.reflect.TypeToken;import dao.CustomerDao;import dao.LocationDao;import dao.jpa.CustomerPersistence;import dao.jpa.LocationPersistence;import dto.CustomerDto;import entity.Location;import exception.DaoException;import exception.DataNotFoundException;import exception.ServiceException;import javax.faces.bean.SessionScoped;import javax.inject.Named;import javax.persistence.NoResultException;import java.util.ArrayList;import java.util.List;@SessionScoped@Namedpublic class CustomerService implements Customer {    public String getData() {        String data;        Gson gson = new Gson();        try {            data = gson.toJson(find(), new TypeToken<List<CustomerDto>>() {}.getType());        } catch (DataNotFoundException ex) {            throw new DataNotFoundException(ex);        } catch (Exception ex) {            throw new ServiceException(ex);        }        return data;    }    public List<CustomerDto> find() {        CustomerDao customerDao = new CustomerPersistence();        LocationDao locationDao = new LocationPersistence();        List<CustomerDto> customersDto = new ArrayList<>();        try {            List<entity.Customer> customers = customerDao.getCustomers();            customers.stream().forEach(customer -> {                Location location = locationDao.getLocation(customer.getId());                CustomerDto customerDto = new CustomerDto();                customerDto.setFirstName(customer.getFirstName());                customerDto.setSurname(customer.getSurname());                customerDto.setDob(location.getCity() + "  " + location.getPostCode());                customerDto.setStreetAddress(location.getStreetAddress());                customersDto.add(customerDto);            });        } catch (DaoException ex) {            if (ex.getCause() instanceof NoResultException) {                throw new DataNotFoundException(ex.getMessage());            }            throw new ServiceException(ex);        } catch (Exception ex) {            throw new ServiceException(ex);        }        return customersDto;    }}